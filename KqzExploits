local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")
local TweenService = game:GetService("TweenService")
local LocalPlayer = Players.LocalPlayer
local Character = LocalPlayer.Character or LocalPlayer.CharacterAdded:Wait()

-- Configuration
local Settings = {
    Enabled = false,
    AutoReturn = true,
    TeleportDelay = 0.5,
    BasePosition = Vector3.new(0, 0, 0),
    ReturnKey = Enum.KeyCode.V
}

local lastPosition = nil
local isTeleporting = false

-- UI Setup
local ScreenGui = Instance.new("ScreenGui")
local MainFrame = Instance.new("Frame")
local TitleLabel = Instance.new("TextLabel")
local StatusButton = Instance.new("TextButton")
local AutoReturnButton = Instance.new("TextButton")
local KeybindLabel = Instance.new("TextLabel")
local UIGradient = Instance.new("UIGradient")
local UICorner = Instance.new("UICorner")
local UIStroke = Instance.new("UIStroke")

ScreenGui.Name = "KqzExploitsUI"
ScreenGui.Parent = game.CoreGui
ScreenGui.ResetOnSpawn = false

MainFrame.Name = "MainFrame"
MainFrame.Parent = ScreenGui
MainFrame.BackgroundColor3 = Color3.fromRGB(15, 15, 20)
MainFrame.Position = UDim2.new(0.5, -110, 0.5, -85)
MainFrame.Size = UDim2.new(0, 220, 0, 170)
MainFrame.BorderSizePixel = 0
MainFrame.Active = true
MainFrame.Draggable = true

UICorner.CornerRadius = UDim.new(0, 15)
UICorner.Parent = MainFrame

UIStroke.Color = Color3.fromRGB(120, 0, 255)
UIStroke.Thickness = 2
UIStroke.ApplyStrokeMode = Enum.ApplyStrokeMode.Border
UIStroke.Parent = MainFrame

UIGradient.Color = ColorSequence.new{
    ColorSequenceKeypoint.new(0, Color3.fromRGB(130, 0, 255)),
    ColorSequenceKeypoint.new(0.5, Color3.fromRGB(70, 0, 180)),
    ColorSequenceKeypoint.new(1, Color3.fromRGB(40, 0, 120))
}
UIGradient.Rotation = 45
UIGradient.Parent = MainFrame

TitleLabel.Name = "Title"
TitleLabel.Parent = MainFrame
TitleLabel.BackgroundTransparency = 1
TitleLabel.Size = UDim2.new(1, 0, 0, 45)
TitleLabel.Font = Enum.Font.GothamBold
TitleLabel.Text = "KqzExploits"
TitleLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
TitleLabel.TextSize = 22

-- Shadow Effect
local Shadow = Instance.new("Frame")
Shadow.Name = "Shadow"
Shadow.Parent = MainFrame
Shadow.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
Shadow.BackgroundTransparency = 0.5
Shadow.Position = UDim2.new(0, 5, 0, 5)
Shadow.Size = UDim2.new(1, 0, 1, 0)
Shadow.ZIndex = -1
Instance.new("UICorner", Shadow).CornerRadius = UDim.new(0, 15)

StatusButton.Name = "StatusButton"
StatusButton.Parent = MainFrame
StatusButton.BackgroundColor3 = Color3.fromRGB(25, 25, 30)
StatusButton.Position = UDim2.new(0.1, 0, 0.32, 0)
StatusButton.Size = UDim2.new(0.8, 0, 0, 35)
StatusButton.Font = Enum.Font.GothamSemibold
StatusButton.Text = "Status: DISABLED"
StatusButton.TextColor3 = Color3.fromRGB(255, 80, 80)
StatusButton.TextSize = 14
Instance.new("UICorner", StatusButton).CornerRadius = UDim.new(0, 10)
Instance.new("UIStroke", StatusButton).Color = Color3.fromRGB(255, 255, 255)

AutoReturnButton.Name = "AutoReturnButton"
AutoReturnButton.Parent = MainFrame
AutoReturnButton.BackgroundColor3 = Color3.fromRGB(25, 25, 30)
AutoReturnButton.Position = UDim2.new(0.1, 0, 0.58, 0)
AutoReturnButton.Size = UDim2.new(0.8, 0, 0, 35)
AutoReturnButton.Font = Enum.Font.GothamSemibold
AutoReturnButton.Text = "Auto-Return: ON"
AutoReturnButton.TextColor3 = Color3.fromRGB(80, 255, 150)
AutoReturnButton.TextSize = 14
Instance.new("UICorner", AutoReturnButton).CornerRadius = UDim.new(0, 10)
Instance.new("UIStroke", AutoReturnButton).Color = Color3.fromRGB(255, 255, 255)

KeybindLabel.Name = "KeybindInfo"
KeybindLabel.Parent = MainFrame
KeybindLabel.BackgroundTransparency = 1
KeybindLabel.Position = UDim2.new(0, 0, 0.85, 0)
KeybindLabel.Size = UDim2.new(1, 0, 0, 20)
KeybindLabel.Font = Enum.Font.GothamMedium
KeybindLabel.Text = "V / Tap / Y to Return"
KeybindLabel.TextColor3 = Color3.fromRGB(220, 220, 255)
KeybindLabel.TextSize = 12

-- Mobile Return Support (Designed Nice)
local ReturnButtonMobile = Instance.new("TextButton")
ReturnButtonMobile.Name = "ReturnButtonMobile"
ReturnButtonMobile.Parent = ScreenGui
ReturnButtonMobile.BackgroundColor3 = Color3.fromRGB(120, 0, 255)
ReturnButtonMobile.Position = UDim2.new(0.85, -30, 0.7, -30)
ReturnButtonMobile.Size = UDim2.new(0, 70, 0, 70)
ReturnButtonMobile.Text = "RETURN"
ReturnButtonMobile.TextColor3 = Color3.fromRGB(255, 255, 255)
ReturnButtonMobile.Font = Enum.Font.GothamBold
ReturnButtonMobile.TextSize = 12
ReturnButtonMobile.Visible = false
Instance.new("UICorner", ReturnButtonMobile).CornerRadius = UDim.new(1, 0)
Instance.new("UIStroke", ReturnButtonMobile).Thickness = 3

-- Functions
local function updateUI()
    StatusButton.Text = "Status: " .. (Settings.Enabled and "ENABLED" or "DISABLED")
    StatusButton.TextColor3 = Settings.Enabled and Color3.fromRGB(80, 255, 150) or Color3.fromRGB(255, 80, 80)
    
    AutoReturnButton.Text = "Auto-Return: " .. (Settings.AutoReturn and "ON" or "OFF")
    AutoReturnButton.TextColor3 = Settings.AutoReturn and Color3.fromRGB(80, 255, 150) or Color3.fromRGB(255, 80, 80)
    
    ReturnButtonMobile.Visible = lastPosition ~= nil and not Settings.AutoReturn
end

local function returnToSavedPosition()
    if lastPosition and not isTeleporting then
        local humanoidRootPart = Character:FindFirstChild("HumanoidRootPart")
        if humanoidRootPart then
            isTeleporting = true
            humanoidRootPart.CFrame = lastPosition
            task.wait(0.2)
            isTeleporting = false
        end
    end
end

StatusButton.MouseButton1Click:Connect(function()
    Settings.Enabled = not Settings.Enabled
    updateUI()
end)

AutoReturnButton.MouseButton1Click:Connect(function()
    Settings.AutoReturn = not Settings.AutoReturn
    updateUI()
end)

ReturnButtonMobile.MouseButton1Click:Connect(returnToSavedPosition)

local function getBasePosition()
    local base = workspace:FindFirstChild("Base") or workspace:FindFirstChild("SpawnLocation") or workspace:FindFirstChild("DropOff") or workspace:FindFirstChild("Goal")
    if base then return base.Position + Vector3.new(0, 5, 0) end
    return Settings.BasePosition
end

local function performInstantBaseTrip()
    if isTeleporting or not Settings.Enabled then return end
    local humanoidRootPart = Character:FindFirstChild("HumanoidRootPart")
    if humanoidRootPart then
        isTeleporting = true
        lastPosition = humanoidRootPart.CFrame
        local basePos = getBasePosition()
        humanoidRootPart.CFrame = CFrame.new(basePos)
        updateUI()
        
        if Settings.AutoReturn then
            task.wait(Settings.TeleportDelay)
            returnToSavedPosition()
        else
            isTeleporting = false
        end
    end
end

local function setupDetection(char)
    char.ChildAdded:Connect(function(child)
        if Settings.Enabled and child:IsA("Tool") and child.Name:lower():find("brainrot") then
            performInstantBaseTrip()
        end
    end)
end

setupDetection(Character)
LocalPlayer.CharacterAdded:Connect(function(newChar)
    Character = newChar
    setupDetection(newChar)
end)

UserInputService.InputBegan:Connect(function(input, processed)
    if not processed then
        if input.KeyCode == Settings.ReturnKey or input.KeyCode == Enum.KeyCode.ButtonY then
            returnToSavedPosition()
        end
    end
end)

print("KqzExploits Premium UI Loaded!")
